<div class='pvp-challenge'>
<div class='corners'>
  <div class='hilight-box'>
    <h1><%=@challenge.challenge_expression.html_safe %></h1>
    <div class='content'>
      <div class='left'>
        <%= image_tag "http://static.nfl.com/static/content/public/image/getty/headshot/#{@p1_thumb}", :alt => 'Player-placeholder', :class => 'player-photo' %>

        <% if (@mypick['status'] == 'pending') %>
          <input type="radio" class="pick" name="pick" id="radio-1" value="<%= @challenge.player1.player_id %>">
          <label class='radio-1' for='radio-1'></label>
        <% end %>

        <h2><%= @challenge.player1.first %> <%= @challenge.player1.last %></h2>
        <strong><%= @challenge.player1.position %></strong>
        <p><%= @team1.name %></p>
      </div>
      <div class='or'>Or</div>
      <div class='right'>
        <%= image_tag "http://static.nfl.com/static/content/public/image/getty/headshot/#{@p2_thumb}", :alt => 'Player-placeholder', :class => 'player-photo' %>

        <% if @mypick['status'] == 'pending' %>
          <input type="radio" class="pick" name="pick" id="radio-2" value="<%=@challenge.player2.player_id%>">
          <label class='radio-2' for='radio-2'></label>
        <% end %>

        <h2><%= @challenge.player2.first %> <%= @challenge.player2.last %></h2>
        <strong><%= @challenge.player2.position %></strong>
        <p><%= @team2.name %></p>
      </div>

      <a class='decision-maker' href='#'>
        <span class='text'>Need help with your decision? Use</span>
        <span class='img'><img alt="Decision-maker-text" src="/images/decision-maker-text.png" /></span>
      </a>

      <% if @mypick['status'] == 'pending' %>
        <a href="#" class="btn-red pick-player" id="submit_response">Submit</a>
      <% end %>
      <!-- <div class='status private'>
              <strong>Private</strong>
              (Only invited users can participate)
            </div>
            <div class="open-till">Open until <strong><span class="time">8:00pm</span> on <span class="date">Monday October 12</span></strong> -->
    </div>
  </div>
</div>

<!-- Create variables to indicate what the actual challenge type is. This should and will be in the back end in the future -->
<% @type = :pvp %>
<!-- Just one wonderful all-purpose response box! -->
<%= render 'your_pick', :type => @type, :pick => @mypick, :challenge => @mypick  %>

  <div class='sub-box the-stakes'>
    <h1>The Stakes:</h1>
    <div class='left'>
      <img alt="Trophy" class="trophy" src="/images/trophy.png" />
      <h3><%= @challenge.stakes %></h3>
    </div>
  </div>

<script language="javascript">
  $('#submit_response').mousedown(function() {
    var player_id = $('.pick:checked').val();
    if (player_id == undefined) {
      alert('Please select a player.');
      return;
    }
    var request = {
      call:'api/challenges/respond',
      dataMethod:'POST',
      data:{
        data:{
          challenge_id : <%=@challenge['id']%>,
          response: player_id,
          status: 'responded'
        }
      },
      response:function(resp,args) {
        if(!resp.success) {
          alert(resp.message);
          return;
        }
        document.location.href = '/challenges/<%=@challenge['id']%>';
      }
    }
    if (USER.id != '0')
      API(request);
    else {
      REQUESTS = []
      REQUESTS.push(request); // Store for after FB Activation
      initConnect();
    }
  })

  $('.invite_friends').mousedown(function() {
    inviteFriends();
  })
</script>